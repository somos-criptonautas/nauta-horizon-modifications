<script>
  if (!CSS.supports("(color: hsl(from white h s l))")) {
    window.unsupportedBrowser = true;
    window.I18n.translations[I18n.locale].js.browser_update =
      'The Horizon theme does not support your browser. Please update your browser, or <a href="?safe_mode=no_themes">switch to safe mode</a>.';
  }
</script>

<!-- Replace icons -->
<script type="text/discourse-plugin" version="0.8">
  api.replaceIcon('robot', 'lightning');
  api.replaceIcon('language', 'translate'´);
  api.replaceIcon('pencil', 'note-pencil');
  api.replaceIcon()
</script>

<!-- Remove closed string on groups -->
<script>
  document.querySelectorAll(".group-membership-button").forEach((div) => {
    if (div.textContent.trim() === "closed" || text === "cerrado") {
      div.style.display = "none";
    }
  });
</script>

<!-- Text on /badges -->
<script>
  (function () {
    var banners = {
      "/badges": {
        id: "custom-badges-banner",
        key: "badges_banner.description",
        link: '<a href="/nuestros-retos">(más info)</a>',
      },
      "/groups": {
        id: "custom-groups-banner",
        key: "groups_banner.description",
        link: '<a href="/nuestros-ghettos">(más info)</a>',
      },
    };

    function injectBanner() {
      var path = window.location.pathname;
      var config = null;

      for (var route in banners) {
        if (path.startsWith(route)) {
          config = banners[route];
          break;
        }
      }

      if (!config) return;
      if (document.getElementById(config.id)) return;

      var target = document.querySelector("#main-outlet-wrapper");
      if (!target) return;

      var banner = document.createElement("div");
      banner.id = config.id;
      banner.innerHTML = `<p>${I18n.t(config.key, { defaultValue: "" })} ${config.link}</p>`;
      banner.style.cssText = ["padding: 0.65rem 1rem"].join(";");

      target.insertAdjacentElement("beforebegin", banner);
    }

    injectBanner();

    var observer = new MutationObserver(function () {
      injectBanner();
    });

    observer.observe(document.body, { childList: true, subtree: true });
  })();
</script>

<!-- Text on /groups -->
<script>
  (function () {
    var banners = {
      "/badges": {
        id: "custom-badges-banner",
        selector: ".badges-page",
        key: "badges_banner.description",
      },
      "/groups": {
        id: "custom-groups-banner",
        selector: ".groups-index",
        key: "groups_banner.description",
      },
    };

    function injectBanner() {
      var path = window.location.pathname;
      var config = null;

      for (var route in banners) {
        if (path.startsWith(route)) {
          config = banners[route];
          break;
        }
      }

      if (!config) return;
      if (document.getElementById(config.id)) return;

      var target = document.querySelector("#main-outlet-wrapper");
      if (!target) return;

      var banner = document.createElement("div");
      banner.id = config.id;
      banner.innerHTML = `<p>${I18n.t(config.key)}</p>`;
      banner.style.cssText = ["padding: 0.7rem 1rem"].join(";");

      target.insertBefore(banner, target.firstChild);
    }

    injectBanner();

    var observer = new MutationObserver(function () {
      injectBanner();
    });

    observer.observe(document.body, { childList: true, subtree: true });
  })();
</script>
